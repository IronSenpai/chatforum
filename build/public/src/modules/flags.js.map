{"version":3,"sources":["public/src/modules/flags.js"],"names":["define","Flag","flagModal","flagCommit","showFlagModal","data","parseModal","html","$","on","remove","find","createFlag","type","id","this","text","val","modal","checkFlagButtonEnable","tplData","callback","templates","parse","require","translator","translate","reason","socket","emit","err","app","alertError","message","alertSuccess","removeAttr","attr"],"mappings":"AAAA,aAGAA,OAAO,WAAa,WACnB,IAAIC,KACJ,IAAIC,EACJ,IAAIC,EAEJF,EAAKG,cAAgB,SAAUC,GAC9BC,EAAWD,EAAM,SAAUE,GAC1BL,EAAYM,EAAED,GAEdL,EAAUO,GAAG,kBAAmB,WAC/BP,EAAUQ,WAGXP,EAAaD,EAAUS,KAAK,qBAE5BT,EAAUO,GAAG,QAAS,eAAgB,WACrCG,EAAWP,EAAKQ,KAAMR,EAAKS,GAAIN,EAAEO,MAAMC,UAGxCb,EAAWM,GAAG,QAAS,WACtBG,EAAWP,EAAKQ,KAAMR,EAAKS,GAAIZ,EAAUS,KAAK,uBAAuBM,SAGtEf,EAAUgB,MAAM,QAEhBhB,EAAUS,KAAK,uBAAuBF,GAAG,oBAAqBU,MAIhE,SAASb,EAAWc,EAASC,GAC5BC,UAAUC,MAAM,6BAA8BH,EAAS,SAAUb,GAChEiB,SAAS,cAAe,SAAUC,GACjCA,EAAWC,UAAUnB,EAAMc,OAK9B,SAAST,EAAWC,EAAMC,EAAIa,GAC7B,IAAKd,IAASC,IAAOa,EAAQ,CAC5B,OAEDC,OAAOC,KAAK,gBAAkBhB,KAAMA,EAAMC,GAAIA,EAAIa,OAAQA,GAAU,SAAUG,GAC7E,GAAIA,EAAK,CACR,OAAOC,IAAIC,WAAWF,EAAIG,SAG3B/B,EAAUgB,MAAM,QAChBa,IAAIG,aAAa,oCAInB,SAASf,IACR,GAAIjB,EAAUS,KAAK,uBAAuBM,MAAO,CAChDd,EAAWgC,WAAW,gBAChB,CACNhC,EAAWiC,KAAK,WAAY,OAI9B,OAAOnC","file":"public/src/modules/flags.js","sourcesContent":["'use strict';\r\n\r\n\r\ndefine('flags', [], function () {\r\n\tvar Flag = {};\r\n\tvar flagModal;\r\n\tvar flagCommit;\r\n\r\n\tFlag.showFlagModal = function (data) {\r\n\t\tparseModal(data, function (html) {\r\n\t\t\tflagModal = $(html);\r\n\r\n\t\t\tflagModal.on('hidden.bs.modal', function () {\r\n\t\t\t\tflagModal.remove();\r\n\t\t\t});\r\n\r\n\t\t\tflagCommit = flagModal.find('#flag-post-commit');\r\n\r\n\t\t\tflagModal.on('click', '.flag-reason', function () {\r\n\t\t\t\tcreateFlag(data.type, data.id, $(this).text());\r\n\t\t\t});\r\n\r\n\t\t\tflagCommit.on('click', function () {\r\n\t\t\t\tcreateFlag(data.type, data.id, flagModal.find('#flag-reason-custom').val());\r\n\t\t\t});\r\n\r\n\t\t\tflagModal.modal('show');\r\n\r\n\t\t\tflagModal.find('#flag-reason-custom').on('keyup blur change', checkFlagButtonEnable);\r\n\t\t});\r\n\t};\r\n\r\n\tfunction parseModal(tplData, callback) {\r\n\t\ttemplates.parse('partials/modals/flag_modal', tplData, function (html) {\r\n\t\t\trequire(['translator'], function (translator) {\r\n\t\t\t\ttranslator.translate(html, callback);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tfunction createFlag(type, id, reason) {\r\n\t\tif (!type || !id || !reason) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tsocket.emit('flags.create', { type: type, id: id, reason: reason }, function (err) {\r\n\t\t\tif (err) {\r\n\t\t\t\treturn app.alertError(err.message);\r\n\t\t\t}\r\n\r\n\t\t\tflagModal.modal('hide');\r\n\t\t\tapp.alertSuccess('[[flags:modal-submit-success]]');\r\n\t\t});\r\n\t}\r\n\r\n\tfunction checkFlagButtonEnable() {\r\n\t\tif (flagModal.find('#flag-reason-custom').val()) {\r\n\t\t\tflagCommit.removeAttr('disabled');\r\n\t\t} else {\r\n\t\t\tflagCommit.attr('disabled', true);\r\n\t\t}\r\n\t}\r\n\r\n\treturn Flag;\r\n});\r\n"]}